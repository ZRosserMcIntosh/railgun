# Rail Gun - Production Environment Configuration
# ================================================
# 
# SECURITY WARNING: 
# - NEVER commit this file with real values
# - Use Fly.io secrets: flyctl secrets set KEY=value
# - Copy to .env for local testing only
#
# This file contains PLACEHOLDER values only.
# All secrets must be rotated from development defaults.

# ===========================================
# Application
# ===========================================
NODE_ENV=production
PORT=3000

# ===========================================
# Database (PostgreSQL)
# ===========================================
# Fly.io: Use attached Postgres (auto-configured via DATABASE_URL)
# Supabase: Get connection string from dashboard
#
DATABASE_URL=postgresql://USER:PASSWORD@HOST:5432/railgun?sslmode=require
# Fly Postgres is auto-attached - no manual config needed

# ===========================================
# Redis
# ===========================================
# Fly.io: Use Upstash Redis (flyctl redis create)
#
REDIS_URL=rediss://default:PASSWORD@HOST:6379

# ===========================================
# JWT Authentication
# ===========================================
# CRITICAL: Generate strong, unique secrets for production
# Use: openssl rand -base64 64
#
JWT_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_64
JWT_EXPIRATION=15m
JWT_REFRESH_SECRET=CHANGE_ME_DIFFERENT_FROM_JWT_SECRET
JWT_REFRESH_EXPIRATION=7d

# CRITICAL: Separate secret for recovery code HMAC (must differ from JWT_SECRET)
# Use: openssl rand -base64 64
RECOVERY_CODE_SECRET=CHANGE_ME_MUST_BE_DIFFERENT_FROM_JWT_SECRET

# ===========================================
# Encryption Keys
# ===========================================
# Server-side encryption key for metadata (NOT for E2EE messages)
# Use: openssl rand -hex 32
#
ENCRYPTION_KEY=CHANGE_ME_64_HEX_CHARACTERS_HERE

# ===========================================
# CORS & Security
# ===========================================
# Comma-separated list of allowed origins
# Be restrictive - only include your actual client domains
#
CORS_ORIGINS=https://your-domain.com,https://app.your-domain.com

# Rate limiting
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=100

# ===========================================
# WebSocket
# ===========================================
WS_PORT=3001
WS_PATH=/ws

# ===========================================
# Logging
# ===========================================
# SECURITY: Never log message contents, tokens, or keys
LOG_LEVEL=info
LOG_FORMAT=json
# Set to 'true' to redact sensitive fields automatically
LOG_REDACT_SENSITIVE=true

# ===========================================
# File Storage (Optional)
# ===========================================
# For encrypted file attachments
# S3_BUCKET=railgun-attachments-prod
# S3_REGION=us-east-1
# S3_ACCESS_KEY_ID=CHANGE_ME
# S3_SECRET_ACCESS_KEY=CHANGE_ME

# ===========================================
# Email (Optional - for recovery codes, etc.)
# ===========================================
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASSWORD=CHANGE_ME
# SMTP_FROM=noreply@your-domain.com

# ===========================================
# Monitoring (Optional)
# ===========================================
# SENTRY_DSN=https://xxx@sentry.io/xxx
# Ensure Sentry is configured to NOT capture message contents

# ===========================================
# Feature Flags
# ===========================================
ENABLE_REGISTRATION=true
ENABLE_COMMUNITIES=true
ENABLE_VOICE_CHANNELS=false
